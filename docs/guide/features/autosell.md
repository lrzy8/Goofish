# 自动发货

路由：`/autosell`

![自动发货](/screenshots/autosell.png)

配置虚拟商品自动发货规则。

## 功能

### 规则列表

显示所有发货规则：
- 规则名称
- 关联商品
- 发货类型
- 库存统计（库存发货类型）
- 启用状态

### 发货类型

| 类型 | 说明 |
|------|------|
| 固定文本 | 每次发送相同的内容 |
| 库存发货 | 从库存中取出一条发送，用完即止 |
| API 取货 | 调用外部 API 获取发货内容 |

### 规则配置

| 字段 | 说明 |
|------|------|
| 规则名称 | 规则的标识名称 |
| 关联商品 | 选择要自动发货的商品 |
| 发货类型 | 固定文本/库存发货/API取货 |
| 发货内容 | 固定文本类型的发货内容 |
| 触发时机 | 待发货/待收货 |
| 关联发货流程 | 选择发货流程（可选） |

### 触发时机

| 时机 | 说明 |
|------|------|
| 待发货 | 买家付款后立即触发 |
| 待收货 | 确认发货后触发 |

## 库存管理

库存发货类型支持库存管理：

### 添加库存

- 在编辑规则时直接输入
- 支持多行，每行一条
- 支持导入文本文件

### 查看库存

点击规则的「库存」按钮：
- 查看所有库存项
- 切换显示已使用/未使用
- 库存统计（总数/已用/剩余）

### 清空库存

- 清空已使用：仅删除已发货的库存
- 清空全部：删除所有库存

## API 取货

API 取货类型配置：

| 字段 | 说明 |
|------|------|
| API 地址 | 请求的 URL |
| 请求方法 | GET 或 POST |
| 请求头 | JSON 格式的 Headers |
| 请求体 | POST 请求的 Body |
| 响应字段 | 从响应中提取内容的字段路径 |

示例响应字段：`data.content` 表示从 `{ data: { content: "xxx" } }` 中提取 `xxx`。
